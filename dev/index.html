<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · VeryBasicCNN.jl</title><meta name="title" content="Home · VeryBasicCNN.jl"/><meta property="og:title" content="Home · VeryBasicCNN.jl"/><meta property="twitter:title" content="Home · VeryBasicCNN.jl"/><meta name="description" content="Documentation for VeryBasicCNN.jl."/><meta property="og:description" content="Documentation for VeryBasicCNN.jl."/><meta property="twitter:description" content="Documentation for VeryBasicCNN.jl."/><meta property="og:url" content="https://kchu25.github.io/VeryBasicCNN.jl/"/><meta property="twitter:url" content="https://kchu25.github.io/VeryBasicCNN.jl/"/><link rel="canonical" href="https://kchu25.github.io/VeryBasicCNN.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>VeryBasicCNN.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/kchu25/VeryBasicCNN.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="VeryBasicCNN"><a class="docs-heading-anchor" href="#VeryBasicCNN">VeryBasicCNN</a><a id="VeryBasicCNN-1"></a><a class="docs-heading-anchor-permalink" href="#VeryBasicCNN" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/kchu25/VeryBasicCNN.jl">VeryBasicCNN</a>.</p><ul><li><a href="#VeryBasicCNN.HyperParamRanges"><code>VeryBasicCNN.HyperParamRanges</code></a></li><li><a href="#VeryBasicCNN.HyperParameters"><code>VeryBasicCNN.HyperParameters</code></a></li><li><a href="#VeryBasicCNN.LearnedCodeImgFilters"><code>VeryBasicCNN.LearnedCodeImgFilters</code></a></li><li><a href="#VeryBasicCNN.LearnedPWMs"><code>VeryBasicCNN.LearnedPWMs</code></a></li><li><a href="#VeryBasicCNN.SeqCNN"><code>VeryBasicCNN.SeqCNN</code></a></li><li><a href="#VeryBasicCNN.SeqCNN-Tuple{Any}"><code>VeryBasicCNN.SeqCNN</code></a></li><li><a href="#Base.getproperty-Tuple{VeryBasicCNN.SeqCNN, Symbol}"><code>Base.getproperty</code></a></li><li><a href="#VeryBasicCNN.apply_maxpool_to_code_image-Tuple{Any}"><code>VeryBasicCNN.apply_maxpool_to_code_image</code></a></li><li><a href="#VeryBasicCNN.apply_pooling_to_code-Tuple{Any}"><code>VeryBasicCNN.apply_pooling_to_code</code></a></li><li><a href="#VeryBasicCNN.calculate_base_layer_output_length-Tuple{Any, Any}"><code>VeryBasicCNN.calculate_base_layer_output_length</code></a></li><li><a href="#VeryBasicCNN.calculate_conv_output_length-Tuple{Any, Any}"><code>VeryBasicCNN.calculate_conv_output_length</code></a></li><li><a href="#VeryBasicCNN.calculate_conv_then_pooled_length-NTuple{4, Any}"><code>VeryBasicCNN.calculate_conv_then_pooled_length</code></a></li><li><a href="#VeryBasicCNN.calculate_final_conv_embedding_length-Tuple{Any, Any}"><code>VeryBasicCNN.calculate_final_conv_embedding_length</code></a></li><li><a href="#VeryBasicCNN.calculate_pooled_length-Tuple{Any, Any, Any}"><code>VeryBasicCNN.calculate_pooled_length</code></a></li><li><a href="#VeryBasicCNN.calculate_pooling_output_dimension-Tuple{Any, Any, Any}"><code>VeryBasicCNN.calculate_pooling_output_dimension</code></a></li><li><a href="#VeryBasicCNN.change_batch_size-Tuple{VeryBasicCNN.HyperParameters, Int64}"><code>VeryBasicCNN.change_batch_size</code></a></li><li><a href="#VeryBasicCNN.cnn_feature_extraction-Tuple{VeryBasicCNN.SeqCNN, Any}"><code>VeryBasicCNN.cnn_feature_extraction</code></a></li><li><a href="#VeryBasicCNN.codeimg_layer_forward_pass-Tuple{VeryBasicCNN.LearnedCodeImgFilters, Any, VeryBasicCNN.HyperParameters}"><code>VeryBasicCNN.codeimg_layer_forward_pass</code></a></li><li><a href="#VeryBasicCNN.compute_training_loss-Tuple{VeryBasicCNN.SeqCNN, Any, Any}"><code>VeryBasicCNN.compute_training_loss</code></a></li><li><a href="#VeryBasicCNN.create_model-Tuple{Any, Any, Int64}"><code>VeryBasicCNN.create_model</code></a></li><li><a href="#VeryBasicCNN.create_position_weight_matrix-Tuple{Any}"><code>VeryBasicCNN.create_position_weight_matrix</code></a></li><li><a href="#VeryBasicCNN.final_embedding_length-Union{Tuple{T}, Tuple{Any, Tuple{T, T}}} where T&lt;:Integer"><code>VeryBasicCNN.final_embedding_length</code></a></li><li><a href="#VeryBasicCNN.generate_random_hyperparameters-Tuple{}"><code>VeryBasicCNN.generate_random_hyperparameters</code></a></li><li><a href="#VeryBasicCNN.get_input_sequence_length-Tuple{Any}"><code>VeryBasicCNN.get_input_sequence_length</code></a></li><li><a href="#VeryBasicCNN.get_level_dimensions-Tuple{Any}"><code>VeryBasicCNN.get_level_dimensions</code></a></li><li><a href="#VeryBasicCNN.get_num_conv_layers_above_base-Tuple{Any}"><code>VeryBasicCNN.get_num_conv_layers_above_base</code></a></li><li><a href="#VeryBasicCNN.get_output_weights-Tuple{VeryBasicCNN.SeqCNN}"><code>VeryBasicCNN.get_output_weights</code></a></li><li><a href="#VeryBasicCNN.get_pooling_size-Tuple{Any, Any}"><code>VeryBasicCNN.get_pooling_size</code></a></li><li><a href="#VeryBasicCNN.get_pooling_tuple-Tuple{Any, Any}"><code>VeryBasicCNN.get_pooling_tuple</code></a></li><li><a href="#VeryBasicCNN.get_stride_size-Tuple{Any, Any}"><code>VeryBasicCNN.get_stride_size</code></a></li><li><a href="#VeryBasicCNN.get_stride_tuple-Tuple{Any, Any}"><code>VeryBasicCNN.get_stride_tuple</code></a></li><li><a href="#VeryBasicCNN.huber_loss-Tuple{Any, Any}"><code>VeryBasicCNN.huber_loss</code></a></li><li><a href="#VeryBasicCNN.initialize_codeimg_activations-Tuple{Any}"><code>VeryBasicCNN.initialize_codeimg_activations</code></a></li><li><a href="#VeryBasicCNN.masked_mse-Tuple{Any, Any, Any}"><code>VeryBasicCNN.masked_mse</code></a></li><li><a href="#VeryBasicCNN.model_init-Union{Tuple{T}, Tuple{VeryBasicCNN.HyperParameters, Tuple{T, T}, T}} where T&lt;:Integer"><code>VeryBasicCNN.model_init</code></a></li><li><a href="#VeryBasicCNN.normalize_conv_filters_l2-Tuple{Any}"><code>VeryBasicCNN.normalize_conv_filters_l2</code></a></li><li><a href="#VeryBasicCNN.normalize_matrix_through_squaring-Tuple{Any}"><code>VeryBasicCNN.normalize_matrix_through_squaring</code></a></li><li><a href="#VeryBasicCNN.predict_from_sequences-Tuple{VeryBasicCNN.SeqCNN, Any}"><code>VeryBasicCNN.predict_from_sequences</code></a></li><li><a href="#VeryBasicCNN.prepare_codeimg_layer_params-Tuple{VeryBasicCNN.LearnedCodeImgFilters}"><code>VeryBasicCNN.prepare_codeimg_layer_params</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.HyperParamRanges" href="#VeryBasicCNN.HyperParamRanges"><code>VeryBasicCNN.HyperParamRanges</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Configuration struct for hyperparameter ranges with current defaults.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/hyperparameters/defaults.jl#L36-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.HyperParameters" href="#VeryBasicCNN.HyperParameters"><code>VeryBasicCNN.HyperParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HyperParameters</code></pre><p>CNN hyperparameters for biological sequence analysis.</p><p><strong>Fields</strong></p><ul><li><code>pfm_len</code>: Length of Position Frequency Matrix (motif length)</li><li><code>num_pfms</code>: Number of PFMs (base layer filters)</li><li><code>num_img_filters</code>: Number of filters per convolutional layer</li><li><code>img_fil_widths</code>: Input channels for each conv layer</li><li><code>img_fil_heights</code>: Filter heights for each conv layer</li><li><code>pool_base</code>: Pooling size for base layer</li><li><code>stride_base</code>: Stride for base layer</li><li><code>poolsize</code>: Pooling sizes for each conv layer</li><li><code>stride</code>: Strides for each conv layer</li><li><code>pool_lvl_top</code>: Highest layer that uses pooling</li><li><code>softmax_strength_img_fil</code>: Softmax strength for filter normalization</li><li><code>batch_size</code>: Training batch size</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/hyperparameters/defaults.jl#L1-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.LearnedCodeImgFilters" href="#VeryBasicCNN.LearnedCodeImgFilters"><code>VeryBasicCNN.LearnedCodeImgFilters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LearnedCodeImgFilters</code></pre><p>Learnable convolutional filters for intermediate CNN layers.</p><p><strong>Fields</strong></p><ul><li><code>filters</code>: 4D array of convolutional filters (height, width, channels, num_filters)</li><li><code>activation_scaler</code>: Scalar activation parameter for the layer</li></ul><p><strong>Constructor Arguments</strong></p><ul><li><code>input_channels</code>: Number of input channels (width of previous layer&#39;s output)</li><li><code>filter_height</code>: Height of convolutional filters</li><li><code>num_filters</code>: Number of filters in this layer</li><li><code>init_scale</code>: Initialization scale factor</li><li><code>use_cuda</code>: Whether to move filters to GPU</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/model.jl#L70-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.LearnedPWMs" href="#VeryBasicCNN.LearnedPWMs"><code>VeryBasicCNN.LearnedPWMs</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LearnedPWMs</code></pre><p>Learnable Position Weight Matrices for the base CNN layer.</p><p><strong>Fields</strong></p><ul><li><code>filters</code>: 4D array of PWM filters (height, width, channels, num_filters)</li><li><code>activation_thresholds</code>: Activation threshold parameters for each filter</li></ul><p><strong>Constructor Arguments</strong></p><ul><li><code>filter_width</code>: Width of PWM filters (motif length)</li><li><code>num_filters</code>: Number of PWM filters to create</li><li><code>init_scale</code>: Initialization scale factor (pseudo count)</li><li><code>use_cuda</code>: Whether to move filters to GPU</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/model.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.SeqCNN" href="#VeryBasicCNN.SeqCNN"><code>VeryBasicCNN.SeqCNN</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SeqCNN</code></pre><p>Convolutional neural network for biological sequence analysis and regression.</p><p>This model implements a multi-layer CNN architecture specifically designed for  biological sequence data (DNA, RNA, proteins) with learnable Position Weight  Matrices (PWMs) as the base layer followed by convolutional layers.</p><p><strong>Architecture Overview</strong></p><ol><li><strong>Base Layer</strong>: Learnable PWMs for motif detection</li><li><strong>Convolutional Layers</strong>: Code image filters with pooling</li><li><strong>Final Layer</strong>: Linear transformation to target outputs</li></ol><p><strong>Fields</strong></p><ul><li><code>position_weight_matrices::LearnedPWMs</code>: Base layer PWM filters for motif detection</li><li><code>convolutional_filters::Vector{LearnedCodeImgFilters}</code>: Multi-layer conv filters</li><li><code>output_weights::AbstractArray{Float,3}</code>: Final linear layer weights (output<em>dim × embed</em>dim × 1)</li><li><code>output_scalers::AbstractArray{Float,1}</code>: Output scaling parameters</li></ul><p><strong>Constructor Arguments</strong></p><ul><li><code>hyperparams</code>: HyperParameters containing architecture specification</li><li><code>sequence_length::Integer</code>: Length of input biological sequences</li><li><code>output_dimension=1</code>: Number of output targets (e.g., binding affinities)</li><li><code>initialization_scale=0.5</code>: Weight initialization scale factor</li><li><code>use_cuda=true</code>: Whether to place model on GPU</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Create model for 41-length DNA sequences with 244 output targets
hp = generate_random_hyperparameters()
model = SeqCNN(hp, 41; output_dimension=244)

# Forward pass
predictions = model(sequences)  # Returns (244, batch_size)</code></pre><p><strong>Notes</strong></p><ul><li>Automatically calculates embedding dimensions based on architecture</li><li>Supports both single and multi-output regression tasks</li><li>Optimized for biological sequence lengths (typically 20-200 nucleotides)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/model.jl#L213-L254">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.SeqCNN-Tuple{Any}" href="#VeryBasicCNN.SeqCNN-Tuple{Any}"><code>VeryBasicCNN.SeqCNN</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">(m::SeqCNN)(seq; make_sparse=false, linear_sum=false, inference_position=nothing)</code></pre><p>Call overload for <code>SeqCNN</code> models to perform a forward pass and generate predictions.</p><p><strong>Arguments</strong></p><ul><li><code>seq</code>: Input biological sequences (one-hot encoded or compatible format)</li><li><code>make_sparse</code>: If true, applies sparsity-inducing normalization to convolutional filters (default: false)</li><li><code>linear_sum</code>: (Unused in this model; included for compatibility)</li><li><code>inference_position</code>: If provided, returns predictions for a specific output position (default: <code>nothing</code> for all outputs)</li></ul><p><strong>Returns</strong></p><ul><li>Model predictions as an array of shape <code>(output_dim, batch_size)</code> </li><li>or <code>(batch_size,)</code> for single-output models</li></ul><p><strong>Notes</strong></p><p>This enables the model to be called as a function, e.g., <code>preds = model(sequences)</code>, for convenient ML-style usage.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/forward.jl#L242-L259">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.getproperty-Tuple{VeryBasicCNN.SeqCNN, Symbol}" href="#Base.getproperty-Tuple{VeryBasicCNN.SeqCNN, Symbol}"><code>Base.getproperty</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.getproperty(m::SeqCNN, sym::Symbol)</code></pre><p>Allow dot-access to <code>batch_size</code> as a virtual field for a <code>SeqCNN</code> model.</p><ul><li><code>model.batch_size</code> returns the batch size from the model&#39;s hyperparameters (<code>model.hp.batch_size</code>).</li><li>All other fields are accessed as usual.</li></ul><p>This enables convenient and familiar ML-style access to the batch size without storing redundant fields.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/forward.jl#L272-L281">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.apply_maxpool_to_code_image-Tuple{Any}" href="#VeryBasicCNN.apply_maxpool_to_code_image-Tuple{Any}"><code>VeryBasicCNN.apply_maxpool_to_code_image</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_maxpool_to_code_image(code_image; poolsize=(2, 1), stride=(1, 1))</code></pre><p>Apply max pooling to 4D code image and reshape to maintain tensor structure.</p><p>This function applies max pooling to code images from convolutional layers, automatically calculating the correct output dimensions and reshaping the result to maintain the expected 4D tensor format (height, width, channels, batch).</p><p><strong>Arguments</strong></p><ul><li><code>code_image</code>: 4D tensor of code image (height, width, channels, batch)</li><li><code>poolsize</code>: Pooling kernel size as (height, width) tuple</li><li><code>stride</code>: Stride of pooling operation as (height, width) tuple</li></ul><p><strong>Returns</strong></p><ul><li>Pooled 4D code image with updated dimensions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/utils.jl#L198-L214">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.apply_pooling_to_code-Tuple{Any}" href="#VeryBasicCNN.apply_pooling_to_code-Tuple{Any}"><code>VeryBasicCNN.apply_pooling_to_code</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_pooling_to_code(code; poolsize=(2,1), stride=(1,1), is_base_layer=false, identity=false, weights=nothing)</code></pre><p>Apply pooling to CNN code with optional weighting and identity bypass.</p><p><strong>Arguments</strong></p><ul><li><code>code</code>: Input code to pool (3D or 4D)</li><li><code>poolsize</code>: Pooling kernel size, default (2,1) for 1D sequences</li><li><code>stride</code>: Pooling stride, default (1,1)</li><li><code>is_base_layer</code>: If true, handles base layer indexing differently</li><li><code>identity</code>: If true, bypasses pooling (for skip connections)</li><li><code>weights</code>: Optional weighting for attention-like mechanisms</li></ul><p><strong>Returns</strong></p><ul><li>Pooled 4D code (height, width, channels, batch)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/utils.jl#L231-L246">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.calculate_base_layer_output_length-Tuple{Any, Any}" href="#VeryBasicCNN.calculate_base_layer_output_length-Tuple{Any, Any}"><code>VeryBasicCNN.calculate_base_layer_output_length</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_base_layer_output_length(hyperparams, sequence_length)</code></pre><p>Calculate the output length after the base layer (first convolution with PFM filters). Formula: output<em>length = sequence</em>length - pfm_length + 1</p><p>This represents the number of possible positions where a PFM of length pfm<em>len can be placed on a sequence of length sequence</em>length.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/utils.jl#L65-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.calculate_conv_output_length-Tuple{Any, Any}" href="#VeryBasicCNN.calculate_conv_output_length-Tuple{Any, Any}"><code>VeryBasicCNN.calculate_conv_output_length</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_conv_output_length(input_length, filter_length)</code></pre><p>Calculate output length after convolution operation. Formula: output<em>length = input</em>length - filter_length + 1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/utils.jl#L45-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.calculate_conv_then_pooled_length-NTuple{4, Any}" href="#VeryBasicCNN.calculate_conv_then_pooled_length-NTuple{4, Any}"><code>VeryBasicCNN.calculate_conv_then_pooled_length</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_conv_then_pooled_length(input_length, filter_length, pool_size, stride)</code></pre><p>Calculate output length after convolution followed by pooling and stride operations. Combines convolution and pooling calculations: conv → pool</p><p><strong>Arguments</strong></p><ul><li><code>input_length</code>: Length of input sequence/tensor</li><li><code>filter_length</code>: Length of convolutional filter</li><li><code>pool_size</code>: Size of pooling kernel</li><li><code>stride</code>: Stride of pooling operation</li></ul><p><strong>Returns</strong></p><ul><li>Final output length after convolution and pooling</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/utils.jl#L95-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.calculate_final_conv_embedding_length-Tuple{Any, Any}" href="#VeryBasicCNN.calculate_final_conv_embedding_length-Tuple{Any, Any}"><code>VeryBasicCNN.calculate_final_conv_embedding_length</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_final_conv_embedding_length(hyperparams, sequence_length)</code></pre><p>Calculate the embedding length after the final convolutional layer.</p><p>This function simulates the forward pass through all CNN layers to determine the final conv embedding dimension that will be fed to downstream layers (e.g., dense layers):</p><ol><li>Base layer: convolution with PFM filters → pooling</li><li>For each subsequent layer up to pool<em>lvl</em>top: conv → pool  </li><li>For remaining layers: conv only (no pooling)</li></ol><p>The result is the length of the convolutional feature vector produced by the last conv layer, which represents the final conv embedding of the input biological sequence.</p><p><strong>Arguments</strong></p><ul><li><code>hyperparams</code>: CNN hyperparameters containing layer specifications</li><li><code>sequence_length</code>: Length of input biological sequence</li></ul><p><strong>Returns</strong></p><ul><li>Final conv embedding length (dimension of feature vector from last conv layer)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/utils.jl#L116-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.calculate_pooled_length-Tuple{Any, Any, Any}" href="#VeryBasicCNN.calculate_pooled_length-Tuple{Any, Any, Any}"><code>VeryBasicCNN.calculate_pooled_length</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_pooled_length(input_length, hyperparams, layer_level)</code></pre><p>Calculate output length after pooling and striding operations. Formula: output<em>length = (input</em>length - pool_size) ÷ stride + 1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/utils.jl#L53-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.calculate_pooling_output_dimension-Tuple{Any, Any, Any}" href="#VeryBasicCNN.calculate_pooling_output_dimension-Tuple{Any, Any, Any}"><code>VeryBasicCNN.calculate_pooling_output_dimension</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_pooling_output_dimension(input_dimension, poolsize, stride)</code></pre><p>Calculate the output dimension after pooling operation. Standard pooling formula: output = (input - poolsize) ÷ stride + 1</p><p><strong>Arguments</strong></p><ul><li><code>input_dimension</code>: Size of input dimension</li><li><code>poolsize</code>: Size of pooling kernel</li><li><code>stride</code>: Stride of pooling operation</li></ul><p><strong>Returns</strong></p><ul><li>Output dimension after pooling</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/utils.jl#L77-L90">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.change_batch_size-Tuple{VeryBasicCNN.HyperParameters, Int64}" href="#VeryBasicCNN.change_batch_size-Tuple{VeryBasicCNN.HyperParameters, Int64}"><code>VeryBasicCNN.change_batch_size</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">change_batch_size(hp, new_batch_size)</code></pre><p>Create a new HyperParameters instance with updated batch size.</p><p><strong>Arguments</strong></p><ul><li><code>hp</code>: Original HyperParameters instance</li><li><code>new_batch_size</code>: New batch size value</li></ul><p><strong>Returns</strong></p><ul><li>New HyperParameters instance with updated batch size</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/hyperparameters/setters.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.cnn_feature_extraction-Tuple{VeryBasicCNN.SeqCNN, Any}" href="#VeryBasicCNN.cnn_feature_extraction-Tuple{VeryBasicCNN.SeqCNN, Any}"><code>VeryBasicCNN.cnn_feature_extraction</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cnn_feature_extraction(hyperparams, model, sequences; make_sparse=false)</code></pre><p>Extract CNN features from biological sequences through full forward pass.</p><p>Performs: PWM base layer → pooling → conv layers → pooling → flatten to embedding vector</p><p><strong>Arguments</strong></p><ul><li><code>hyperparams</code>: CNN hyperparameters</li><li><code>model</code>: Trained CNN model instance</li><li><code>sequences</code>: Input biological sequences (GPU array)</li><li><code>make_sparse</code>: Apply sparsity-inducing filter normalization</li></ul><p><strong>Returns</strong></p><ul><li>Flattened feature embedding (final<em>length, 1, batch</em>size)</li></ul><p>Note:      All the hidden<em>layer</em>out, i.e. code in this mode is      of the shape (code<em>length, num</em>filters<em>prev</em>layer, 1, batch<em>size);     this can be seen in the function apply</em>pooling<em>to</em>code (utils.jl).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/forward.jl#L118-L139">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.codeimg_layer_forward_pass-Tuple{VeryBasicCNN.LearnedCodeImgFilters, Any, VeryBasicCNN.HyperParameters}" href="#VeryBasicCNN.codeimg_layer_forward_pass-Tuple{VeryBasicCNN.LearnedCodeImgFilters, Any, VeryBasicCNN.HyperParameters}"><code>VeryBasicCNN.codeimg_layer_forward_pass</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">codeimg_layer_forward_pass(conv_filters, prev_code_img, hp; return_filters=false, make_sparse=false)</code></pre><p>Forward pass through a code image convolutional layer.</p><p><strong>Arguments</strong></p><ul><li><code>conv_filters</code>: LearnedCodeImgFilters instance</li><li><code>prev_code_img</code>: Previous layer&#39;s code image output</li><li><code>hp</code>: HyperParameters containing layer configuration</li><li><code>return_filters</code>: Whether to return normalized filters along with output</li><li><code>make_sparse</code>: Whether to apply sparsity-inducing filter normalization</li></ul><p><strong>Returns</strong></p><ul><li><code>code</code>: Activated code image output</li><li><code>normalized_filters</code>: (Optional) Normalized filters if return_filters=true</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/model.jl#L161-L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.compute_training_loss-Tuple{VeryBasicCNN.SeqCNN, Any, Any}" href="#VeryBasicCNN.compute_training_loss-Tuple{VeryBasicCNN.SeqCNN, Any, Any}"><code>VeryBasicCNN.compute_training_loss</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_training_loss(model, hyperparams, sequences, targets; make_sparse=false, verbose=true)</code></pre><p>Compute the training objective (Huber loss) for the biological sequence CNN model.</p><p>This function performs a complete forward pass through the model and computes the robust Huber loss for training the CNN on biological sequence data.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: Trained or training CNN model instance</li><li><code>sequences</code>: Input biological sequences (typically on GPU)</li><li><code>targets</code>: Ground truth target values for regression</li><li><code>make_sparse</code>: Whether to apply sparsity-inducing filter normalization</li><li><code>verbose</code>: Whether to print loss value during training</li></ul><p><strong>Returns</strong></p><ul><li>Scalar loss value for optimization</li></ul><p><strong>Notes</strong></p><ul><li>Uses Huber loss for robustness to outliers in biological data</li><li>Handles NaN values in targets automatically</li><li>Supports sparse filter training for interpretability</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/loss.jl#L75-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.create_model-Tuple{Any, Any, Int64}" href="#VeryBasicCNN.create_model-Tuple{Any, Any, Int64}"><code>VeryBasicCNN.create_model</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_model(X_dim, Y_dim, batch_size::Int; rng=Random.GLOBAL_RNG, use_cuda::Bool=true)</code></pre><p>Construct a new <code>SeqCNN</code> model with randomly generated hyperparameters and specified data dimensions.</p><p><strong>Arguments</strong></p><ul><li><code>X_dim::Tuple{Int, Int}</code>: Input data dimensions as (height, sequence_length).</li><li><code>Y_dim::Int</code>: Number of output targets (e.g., regression outputs).</li><li><code>batch_size::Int</code>: Batch size for hyperparameter generation.</li><li><code>rng</code>: (Optional) Random number generator to use for hyperparameter sampling (default: <code>Random.GLOBAL_RNG</code>).</li><li><code>use_cuda::Bool</code>: (Optional) Whether to place model parameters on GPU (default: <code>true</code>).</li></ul><p><strong>Returns</strong></p><ul><li>A new <code>SeqCNN</code> model instance if the final embedding length is valid (≥ 1), otherwise <code>nothing</code>.</li></ul><p><strong>Notes</strong></p><ul><li>Hyperparameters are generated randomly for each call unless a specific RNG is provided.</li><li>Returns <code>nothing</code> if the model architecture is invalid for the given input dimensions.</li><li>The <code>use_cuda</code> flag controls whether model parameters are moved to GPU.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/model.jl#L350-L369">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.create_position_weight_matrix-Tuple{Any}" href="#VeryBasicCNN.create_position_weight_matrix-Tuple{Any}"><code>VeryBasicCNN.create_position_weight_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_position_weight_matrix(frequencies; background=bg, reverse_comp=false)</code></pre><p>Create a Position Weight Matrix (PWM) from frequency matrix. Converts frequency counts to log2 odds ratios relative to background distribution.</p><p><strong>Arguments</strong></p><ul><li><code>frequencies</code>: Matrix of nucleotide/amino acid frequencies</li><li><code>background</code>: Background probability distribution (defaults to uniform)</li><li><code>reverse_comp</code>: If true, include reverse complement in the PWM</li></ul><p><strong>Returns</strong></p><ul><li>Position Weight Matrix with log2 odds ratios</li></ul><p><strong>Notes</strong></p><p>This is standard PWM construction: PWM[i,j] = log2(freq[i,j] / background[i])</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/forward.jl#L58-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.final_embedding_length-Union{Tuple{T}, Tuple{Any, Tuple{T, T}}} where T&lt;:Integer" href="#VeryBasicCNN.final_embedding_length-Union{Tuple{T}, Tuple{Any, Tuple{T, T}}} where T&lt;:Integer"><code>VeryBasicCNN.final_embedding_length</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">final_embedding_len(hp, X_dim::Tuple{T, T}) where T &lt;: Integer</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/utils.jl#L158-L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.generate_random_hyperparameters-Tuple{}" href="#VeryBasicCNN.generate_random_hyperparameters-Tuple{}"><code>VeryBasicCNN.generate_random_hyperparameters</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_random_hyperparameters(; batch_size=nothing, rng=Random.GLOBAL_RNG, ranges=DEFAULT_RANGES)</code></pre><p>Generate random hyperparameters for CNN hyperparameter tuning experiments.</p><p>This function creates randomized but sensible hyperparameter configurations for biological sequence CNN training, useful for hyperparameter search and ablation studies.</p><p><strong>Arguments</strong></p><ul><li><code>batch_size</code>: Fixed batch size (if nothing, randomly selected from available options in <code>ranges.batch_size_options</code>)</li><li><code>rng</code>: Random number generator to use (default: <code>Random.GLOBAL_RNG</code>)</li><li><code>ranges</code>: Struct containing parameter ranges and options (default: <code>DEFAULT_RANGES</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>HyperParameters</code>: Randomized hyperparameter configuration</li></ul><p><strong>Parameter Ranges (from <code>ranges</code>)</strong></p><ul><li><code>pfm_len</code>: motif length range (e.g., 6-15)</li><li><code>num_pfms</code>: base layer filter count (e.g., 256-512)</li><li><code>conv_filter_counts</code>: per-layer filter counts (e.g., 256-512)</li><li><code>filter_heights</code>: filter heights for each conv layer (e.g., 2-5)</li><li><code>pooling_sizes</code>: pooling sizes for each conv layer (e.g., 1-2)</li><li><code>strides</code>: stride for each conv layer (e.g., 1)</li></ul><p><strong>Notes</strong></p><ul><li>Last conv layer uses a fixed number of filters for compatibility with final embedding</li><li>Pooling parameters are conservative to avoid over-downsampling</li><li>All stride patterns end with 1 to preserve final resolution</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/hyperparameters/random.jl#L1-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.get_input_sequence_length-Tuple{Any}" href="#VeryBasicCNN.get_input_sequence_length-Tuple{Any}"><code>VeryBasicCNN.get_input_sequence_length</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_input_sequence_length(data)</code></pre><p>Extract the input sequence length from data structure.</p><p><strong>Arguments</strong></p><ul><li><code>data</code>: Data structure containing sequence matrices</li></ul><p><strong>Returns</strong></p><ul><li>Length of input sequences (second dimension of first matrix)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/hyperparameters/getters.jl#L17-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.get_level_dimensions-Tuple{Any}" href="#VeryBasicCNN.get_level_dimensions-Tuple{Any}"><code>VeryBasicCNN.get_level_dimensions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_level_dimensions(tensor; is_base_layer=false)</code></pre><p>Get relevant tensor dimensions for CNN layer operations.</p><p>For biological sequence CNNs, this function extracts the dimensions needed for pooling and reshaping operations, handling the different tensor layouts between base layer and subsequent layers.</p><p><strong>Arguments</strong></p><ul><li><code>tensor</code>: Input tensor (4D: height, width, channels, batch)</li><li><code>is_base_layer</code>: If true, treats as base layer with different dimension indexing</li></ul><p><strong>Returns</strong></p><ul><li>Tuple of (relevant<em>dim, channels, batch</em>size) for layer operations</li></ul><p><strong>Notes</strong></p><ul><li>Base layer: uses dimensions (2, 3, 4) → (width, channels, batch)  </li><li>Other layers: uses dimensions (1, 3, 4) → (height, channels, batch)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/utils.jl#L166-L185">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.get_num_conv_layers_above_base-Tuple{Any}" href="#VeryBasicCNN.get_num_conv_layers_above_base-Tuple{Any}"><code>VeryBasicCNN.get_num_conv_layers_above_base</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_num_conv_layers_above_base(hp)</code></pre><p>Get the number of convolutional layers above the base layer.</p><p><strong>Arguments</strong></p><ul><li><code>hp</code>: HyperParameters instance</li></ul><p><strong>Returns</strong></p><ul><li>Number of conv layers above base (excludes PFM base layer)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/hyperparameters/getters.jl#L2-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.get_output_weights-Tuple{VeryBasicCNN.SeqCNN}" href="#VeryBasicCNN.get_output_weights-Tuple{VeryBasicCNN.SeqCNN}"><code>VeryBasicCNN.get_output_weights</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_output_weights(model::SeqCNN)</code></pre><p>Extract the output layer weights from a SeqCNN model.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: SeqCNN instance</li></ul><p><strong>Returns</strong></p><ul><li>Output weights tensor (output<em>dim, embedding</em>dim, 1)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/model.jl#L388-L398">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.get_pooling_size-Tuple{Any, Any}" href="#VeryBasicCNN.get_pooling_size-Tuple{Any, Any}"><code>VeryBasicCNN.get_pooling_size</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_pooling_size(hyperparams, layer_level)</code></pre><p>Get the pooling size for a specific CNN layer.</p><ul><li>Layer 0 (base): uses pool_base</li><li>Other layers: uses poolsize[layer_level]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/utils.jl#L5-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.get_pooling_tuple-Tuple{Any, Any}" href="#VeryBasicCNN.get_pooling_tuple-Tuple{Any, Any}"><code>VeryBasicCNN.get_pooling_tuple</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_pooling_tuple(hyperparams, layer_level)</code></pre><p>Get the pooling size as a tuple (height, width) for convolution operations. Returns (pooling_size, 1) since these are 1D sequences treated as 2D.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/utils.jl#L14-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.get_stride_size-Tuple{Any, Any}" href="#VeryBasicCNN.get_stride_size-Tuple{Any, Any}"><code>VeryBasicCNN.get_stride_size</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_stride_size(hyperparams, layer_level)</code></pre><p>Get the stride size for a specific CNN layer.</p><ul><li>Layer 0 (base): uses stride_base  </li><li>Other layers: uses stride[layer_level]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/utils.jl#L22-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.get_stride_tuple-Tuple{Any, Any}" href="#VeryBasicCNN.get_stride_tuple-Tuple{Any, Any}"><code>VeryBasicCNN.get_stride_tuple</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_stride_tuple(hyperparams, layer_level)</code></pre><p>Get the stride size as a tuple (height, width) for convolution operations. Returns (stride_size, 1) since these are 1D sequences treated as 2D.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/utils.jl#L31-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.huber_loss-Tuple{Any, Any}" href="#VeryBasicCNN.huber_loss-Tuple{Any, Any}"><code>VeryBasicCNN.huber_loss</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">huber_loss(predictions, targets; delta=0.85, quadratic_weight=0.5)</code></pre><p>Compute Huber loss with NaN handling for robust regression training.</p><p>The Huber loss combines quadratic loss for small errors and linear loss for large errors, making it robust to outliers while remaining smooth and differentiable.</p><p><strong>Arguments</strong></p><ul><li><code>predictions</code>: Model predictions (ŷ)</li><li><code>targets</code>: Ground truth target values (y)  </li><li><code>delta</code>: Threshold for switching between quadratic and linear loss</li><li><code>quadratic_weight</code>: Weight factor for quadratic loss component (default 0.5)</li></ul><p><strong>Returns</strong></p><ul><li>Mean Huber loss over valid (non-NaN) data points</li></ul><p><strong>Notes</strong></p><ul><li>NaN values in targets are automatically excluded from loss calculation</li><li>For |error| &lt; delta: loss = quadratic_weight * error²</li><li>For |error| ≥ delta: loss = delta * (|error| - quadratic_weight * delta)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/loss.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.initialize_codeimg_activations-Tuple{Any}" href="#VeryBasicCNN.initialize_codeimg_activations-Tuple{Any}"><code>VeryBasicCNN.initialize_codeimg_activations</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize_codeimg_activations(gradient)</code></pre><p>Initialize code image activations using ReLU activation.</p><p><strong>Arguments</strong></p><ul><li><code>gradient</code>: Raw convolution output gradients</li></ul><p><strong>Returns</strong></p><ul><li>ReLU-activated code image</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/model.jl#L145-L155">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.masked_mse-Tuple{Any, Any, Any}" href="#VeryBasicCNN.masked_mse-Tuple{Any, Any, Any}"><code>VeryBasicCNN.masked_mse</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">masked_mse(predictions, targets, mask)</code></pre><p>Compute mean squared error only on valid (masked) entries.</p><p><strong>Arguments</strong></p><ul><li><code>predictions</code>: Model predictions</li><li><code>targets</code>: Ground truth targets  </li><li><code>mask</code>: Boolean mask indicating valid entries</li></ul><p><strong>Returns</strong></p><ul><li>MSE computed only on valid entries specified by mask</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/loss.jl#L52-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.model_init-Union{Tuple{T}, Tuple{VeryBasicCNN.HyperParameters, Tuple{T, T}, T}} where T&lt;:Integer" href="#VeryBasicCNN.model_init-Union{Tuple{T}, Tuple{VeryBasicCNN.HyperParameters, Tuple{T, T}, T}} where T&lt;:Integer"><code>VeryBasicCNN.model_init</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">model_init(hp::HyperParameters, X_dim::Tuple{T, T}, Y_dim::T; kwargs...) where T &lt;: Integer</code></pre><p>Create a SeqCNN model instance given hyperparameters and data dimensions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/model.jl#L342-L345">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.normalize_conv_filters_l2-Tuple{Any}" href="#VeryBasicCNN.normalize_conv_filters_l2-Tuple{Any}"><code>VeryBasicCNN.normalize_conv_filters_l2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalize_conv_filters_l2(filters; softmax_strength=SOFTMAX_ALPHA, use_sparsity=false)</code></pre><p>Normalize CNN filters using L2 normalization, with optional sparsity-inducing softmax weighting.</p><p><strong>Arguments</strong></p><ul><li><code>filters</code>: Convolutional filter weights to normalize</li><li><code>softmax_strength</code>: Strength parameter for softmax sparsity (higher = more sparse)</li><li><code>use_sparsity</code>: If true, applies softmax weighting to encourage sparsity</li></ul><p><strong>Returns</strong></p><ul><li>L2-normalized filters, optionally with sparsity-inducing weights</li></ul><p><strong>Notes</strong></p><ul><li>L2 normalization helps with gradient stability and convergence</li><li>Sparsity option uses softmax to emphasize larger weights and suppress smaller ones</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/forward.jl#L84-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.normalize_matrix_through_squaring-Tuple{Any}" href="#VeryBasicCNN.normalize_matrix_through_squaring-Tuple{Any}"><code>VeryBasicCNN.normalize_matrix_through_squaring</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalize_matrix_through_squaring(matrix; ϵ=1e-5, reverse_comp=false)</code></pre><p>Normalize a matrix by squaring elements and normalizing by column sums.</p><ul><li>Squares matrix elements and adds epsilon for numerical stability</li><li>Normalizes by column sums (creates probability-like distribution)</li><li>Optionally creates reverse complement and concatenates along dimension 4</li></ul><p><strong>Arguments</strong></p><ul><li><code>matrix</code>: Input matrix to normalize</li><li><code>ϵ</code>: Small value added for numerical stability (prevents division by zero)</li><li><code>reverse_comp</code>: If true, creates reverse complement and concatenates</li></ul><p><strong>Returns</strong></p><ul><li>Normalized matrix with optional reverse complement concatenated along dimension 4</li></ul><p><strong>Notes</strong></p><p>This creates a probability-like distribution from squared values, useful for  converting frequency matrices to pseudo-probability matrices in PWM construction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/forward.jl#L5-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.predict_from_sequences-Tuple{VeryBasicCNN.SeqCNN, Any}" href="#VeryBasicCNN.predict_from_sequences-Tuple{VeryBasicCNN.SeqCNN, Any}"><code>VeryBasicCNN.predict_from_sequences</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">predict_from_sequences(hyperparams, model, sequences; make_sparse=false)</code></pre><p>Complete forward pass: CNN feature extraction → linear transformation → final predictions.</p><p><strong>Arguments</strong></p><ul><li><code>hyperparams</code>: CNN hyperparameters</li><li><code>model</code>: Trained CNN model instance  </li><li><code>sequences</code>: Input biological sequences</li><li><code>make_sparse</code>: Apply sparsity-inducing normalization</li></ul><p><strong>Returns</strong></p><ul><li>Model predictions (output<em>dim, batch</em>size)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/forward.jl#L191-L204">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VeryBasicCNN.prepare_codeimg_layer_params-Tuple{VeryBasicCNN.LearnedCodeImgFilters}" href="#VeryBasicCNN.prepare_codeimg_layer_params-Tuple{VeryBasicCNN.LearnedCodeImgFilters}"><code>VeryBasicCNN.prepare_codeimg_layer_params</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_codeimg_layer_params(conv_filters; alpha=SOFTMAX_ALPHA, make_sparse=false)</code></pre><p>Prepare normalized filters and activation scalers for code image convolution layer.</p><p><strong>Arguments</strong></p><ul><li><code>conv_filters</code>: LearnedCodeImgFilters instance containing raw filters and scalers</li><li><code>alpha</code>: Softmax strength for sparsity-inducing normalization</li><li><code>make_sparse</code>: Whether to apply sparsity-inducing normalization</li></ul><p><strong>Returns</strong></p><ul><li><code>normalized_filters</code>: L2-normalized convolutional filters, optionally with sparsity</li><li><code>activation_scaler</code>: Processed activation scaler (squared and clamped)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kchu25/VeryBasicCNN.jl/blob/5c33e9ef95d0b0aa2ef8edc04291b37f82c1acd5/src/model/model.jl#L119-L132">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 24 September 2025 19:34">Wednesday 24 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
